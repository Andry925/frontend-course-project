!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="69097d44-e1a6-4bbd-a455-b59b91d8d36c",e._sentryDebugIdIdentifier="sentry-dbid-69097d44-e1a6-4bbd-a455-b59b91d8d36c")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"385b963232c485d0dd13a35b1acc0e9158ff9321"},(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{1046:function(e,t,o){var content=o(1913);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(207).default)("3e2abd67",content,!0,{sourceMap:!1})},1912:function(e,t,o){"use strict";o(1046)},1913:function(e,t,o){var r=o(206),n=o(267),c=o(1914),d=r((function(i){return i[1]})),l=n(c);d.push([e.i,".price-history[data-v-5f9960ba]{align-items:center;border:.1rem solid #e7e7e7;border-radius:.8rem;display:flex;flex-flow:row wrap;gap:1.2rem;padding:1.6rem}.price-history__icon[data-v-5f9960ba]{background-image:url("+l+");height:1.8rem;width:2.4rem}.price-history__last-change[data-v-5f9960ba]{font-size:1.6rem;font-weight:700}.price-history__modal-toggler[data-v-5f9960ba]{margin-left:auto}@media (max-width:46.24em){.price-history__modal-toggler[data-v-5f9960ba]{margin-left:0}}.price-history__modal-toggler__icon[data-v-5f9960ba]{opacity:0}@media (max-width:46.24em){.price-history__modal-toggler__icon[data-v-5f9960ba]{opacity:1}}.price-history-modal[data-v-5f9960ba]{display:flex;flex-flow:column nowrap;gap:2.4rem;padding:1.6rem}.price-history-modal__header[data-v-5f9960ba]{align-items:center;display:flex;font-size:1.6rem;font-weight:500;gap:1.4rem;line-height:2.7rem}.price-history-modal__header__icon[data-v-5f9960ba]{background-image:url("+l+");height:1.8rem;width:2.4rem}.price-history-modal__title[data-v-5f9960ba]{font-size:1.6rem;font-weight:500}.price-history-modal__close[data-v-5f9960ba]{color:#a7a7a7;cursor:pointer;font-size:2rem;font-weight:500;margin-left:auto}.price-history-modal__list[data-v-5f9960ba]{align-items:flex-end;background:#fff;background:repeating-linear-gradient(0deg,#fff,#fff 20%,#eaeaea 0,#eaeaea calc(20% + 1.4px));border:1px solid #eaeaea;border-radius:8px;box-sizing:border-box;display:flex;height:280px;justify-content:space-around;width:100%}.price-history-modal__list__item[data-v-5f9960ba]{align-items:flex-end;display:flex;height:calc(80% + 5px);position:relative;width:44px}.price-history-modal__list__item__price[data-v-5f9960ba]{font-size:1.6rem;font-weight:500;left:50%;position:absolute;top:-24px;transform:translate(-50%);white-space:nowrap;width:-moz-fit-content;width:fit-content;word-break:keep-all}.price-history-modal__list__item__block[data-v-5f9960ba]{align-items:center;background:#eaeaea;border-radius:8px 8px 0 0;display:flex;height:100%;justify-content:center;position:relative;width:100%}.price-history-modal__list__item__block__actual[data-v-5f9960ba]{background-color:#ffca00}.price-history-modal__list__item__time[data-v-5f9960ba]{bottom:-32px;color:#8a8a8a;left:50%;position:absolute;text-transform:lowercase;transform:translate(-50%);white-space:nowrap;word-break:keep-all}.price-history-modal__total-change[data-v-5f9960ba]{align-items:center;background:rgba(255,238,173,.6);border-radius:8px;display:flex;font-size:1.4rem;font-weight:500;gap:6px;margin-top:30px;padding:1.6rem;width:100%}.price-history-modal__total-change__icon[data-v-5f9960ba]{color:#ffca00}.price-history-modal__total-change__percent[data-v-5f9960ba]{font-weight:700}.price-history-modal__actions[data-v-5f9960ba]{display:flex;flex-flow:column nowrap;gap:8px}",""]),d.locals={},e.exports=d},1914:function(e,t,o){e.exports=o.p+"img/price-history.a7395db.svg"},2129:function(e,t,o){"use strict";o.r(t);o(210);var r=o(43),n=o(227),c=o(85),d=(o(83),o(209),o(220),o(139),o(82),o(214),o(216),o(141),o(142),o(140),o(58),o(224),o(59),o(205)),l=o(208),f=o(218),_=o(215),m=o(1074),v=o(213),h=o(279),y=o(217),w=o(516),O=o(300),C=o(212),x=o(211),j=o(324);function k(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function M(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?k(Object(o),!0).forEach((function(t){Object(c.a)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):k(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var S=Object(d.defineComponent)({__name:"OfferPriceHistory",props:{priceHistory:null,price:null,product:null},setup:function(e){var t=e,o=Object(l.x)(),c=o.$dayjs,k=o.i18n,S=o.$vfm,P=o.$toast,H=Object(h.a)(),B=Object(w.a)(),D=Object(v.a)(),I=Object(y.a)(),E=Object(O.a)(),$=Object(d.shallowRef)(!1),T=Object(d.computed)((function(){var e,o;return B.offerCodes.includes((null===(o=null===(e=t.product)||void 0===e?void 0:e.offer_main)||void 0===o?void 0:o.code)||"")})),W=Object(d.computed)((function(){return I.isAuthenticated})),z=Object(d.computed)((function(){return A.value.price-t.price>0})),A=Object(d.computed)((function(){return t.priceHistory[0]})),J=Object(d.computed)((function(){var e=z.value?A.value.price-t.price:t.price-A.value.price;return Object(x.r)(e)})),R=Object(d.computed)((function(){return z.value?k.t("offers.price_dropped",{time:G(A.value.created_at)}):k.t("offers.price_increased",{time:G(A.value.created_at)})})),N=function(e){return 0===e?"0%":e>0?"+".concat(e,"%"):"".concat(e,"%")},L=Object(d.computed)((function(){var e=t.priceHistory.slice(0,3);return e.unshift({price:t.price,created_at:(new Date).toISOString()}),e.reverse(),e.map((function(t,o){var r=o?Object(j.b)(t.price,e[o-1].price):0;return M(M({},t),{},{price_change:N(r),formatedTime:Y(t.created_at)})}))})),F=Object(d.computed)((function(){return Math.max.apply(Math,Object(n.a)(L.value.map((function(e){return e.price}))))})),U=Object(d.computed)((function(){var e=c(),t=c(L.value[0].created_at);return e.startOf("day").diff(t.startOf("day"),"days")})),V=Object(d.computed)((function(){return"".concat(Object(j.b)(t.price,L.value[0].price),"%")})),G=function(time){var e=c(),t=c(time),o=e.startOf("day").diff(t.startOf("day"),"days");if(o>1)return t.format("DD MMMM");var r=e.diff(t,"minutes");return r<60?k.t("offers.price_changed_now"):r<120?k.t("offers.price_change_hour"):r<180?k.t("offers.price_change_2_hours"):Boolean(o)?k.t("offers.price_changed_yesterday"):k.t("offers.price_changed_today")},Y=function(time){var e=c(),t=c(time),o=e.startOf("day").diff(t.startOf("day"),"days");return o>1?"-".concat(o," ").concat(k.tc("offers.day_pluralized",o)):Boolean(o)?k.t("offers.price_changed_yesterday"):k.t("offers.price_changed_today")},K=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var o,r,n,c,d,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.product.offer_main){$.value=!0;try{T.value?(B.removeFromWishlist(null===(c=null===(n=t.product)||void 0===n?void 0:n.offer_main)||void 0===c?void 0:c.code),D.addMetricEvent({element:"ms[wishlist-remove-product]",event_type:"click",event_content:JSON.stringify({productCode:t.product.p_code,offerCode:null===(l=null===(d=t.product)||void 0===d?void 0:d.offer_main)||void 0===l?void 0:l.code,modalHistory:!0})}),H.decrementWishlistCount()):(B.addToWishlist(t.product.offer_main.code),D.addMetricEvent({element:"ms[wishlist-add-product]",event_type:"click",event_content:JSON.stringify({productCode:t.product.p_code,offerCode:null===(r=null===(o=t.product)||void 0===o?void 0:o.offer_main)||void 0===r?void 0:r.code,modalHistory:!0})}),window.fbq("track","AddToWishlist",{content_name:t.product.name,content_ids:[t.product.p_code],content_type:"product"}),H.incrementWishListCount())}finally{$.value=!1}}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){S.open(_.a,{form:"login",loginCallback:K})},X=function(){var e,o;S.close(_.t),D.addMetricEvent({element:"ms[modal-history-hide]",event_type:"click",event_content:JSON.stringify({productCode:t.product.p_code,offerCode:null===(o=null===(e=t.product)||void 0===e?void 0:e.offer_main)||void 0===o?void 0:o.code})})},Z=Object(d.shallowRef)(!1),ee=Object(d.computed)((function(){return!!t.product.offer_main&&E.addedOffer(t.product.offer_main.uuid)})),te=Object(d.computed)((function(){return I.ageRestrictions})),ie=Object(d.computed)((function(){var e;return(null===(e=t.product.category)||void 0===e?void 0:e.ar_d)&&(te.value||null===te.value)}));return{__sfc:!0,props:t,$dayjs:c,i18n:k,$vfm:S,$toast:P,productStore:H,wishlistOffersStore:B,commonMetricsStore:D,authUserStore:I,cartStore:E,isFetching:$,inWishlist:T,isAuthenticated:W,isPriceDropped:z,lastPriceChange:A,lastPriceChangeSum:J,lastPriceChangeLabel:R,formatPriceChange:N,historyToShow:L,biggestPrice:F,totalDays:U,totalChange:V,getBlockHeight:function(e){return Math.floor(e/F.value*100)},getLastTimeChange:G,getPriceTimeChange:Y,toggleWishlist:function(){var e,o;D.addMetricEvent({element:"ms[follow_price]",event_type:"click",event_content:JSON.stringify({productCode:t.product.p_code,offerCode:null===(o=null===(e=t.product)||void 0===e?void 0:e.offer_main)||void 0===o?void 0:o.code})}),W.value?K():Q()},toggleUserWishlist:K,toggleGuestWishlist:Q,onViewHistoryModal:function(){var e,o;D.addMetricEvent({element:"ms[modal-history-show]",event_type:"view",event_content:JSON.stringify({productCode:t.product.p_code,offerCode:null===(o=null===(e=t.product)||void 0===e?void 0:e.offer_main)||void 0===o?void 0:o.code})})},onOpenHistoryModal:function(){var e,o;S.open(_.t),D.addMetricEvent({element:"ms[modal-history-show]",event_type:"click",event_content:JSON.stringify({productCode:t.product.p_code,offerCode:null===(o=null===(e=t.product)||void 0===e?void 0:e.offer_main)||void 0===o?void 0:o.code})})},onHideHistoryModal:X,isAddingCart:Z,isOfferInCart:ee,ageRestrictions:te,disableBuyButton:ie,handleAddToCart:function(){var e,o;if(window.navigator.onLine){if(ee.value)return X(),S.open("cart");Z.value=!0;try{E.addToCart({offerId:(null===(e=t.product.offer_main)||void 0===e?void 0:e.uuid)||"",product:t.product,showCart:!1}),D.addMetricEvent({element:"ms[product-buy-add-to-cart]",event_type:"click",event_content:(null===(o=t.product.offer_main)||void 0===o?void 0:o.code)||""})}finally{Z.value=!1}}else P.error(k.t("common.general_errors.error_503_text"),C.wb)},IntersectionObserver:f.a,modalPriceHistoryId:_.t,BaseButton:m.a}}}),P=S,H=(o(1912),o(204)),component=Object(H.a)(P,(function(){var e=this,t=e._self._c,o=e._self._setupProxy;return t("div",{staticClass:"price-history"},[t("div",{staticClass:"price-history__icon"}),e._v(" "),t("div",[e._v("\n    "+e._s(o.lastPriceChangeLabel)+"\n    "),t("span",{staticClass:"price-history__last-change"},[e._v("\n      "+e._s(o.lastPriceChangeSum)+"\n      "),t("span",{staticClass:"icon-hryvnia"})])]),e._v(" "),t(o.IntersectionObserver,{attrs:{observe:"","once-intersecting":""},on:{intersectEnter:o.onViewHistoryModal}},[t(o.BaseButton,{staticClass:"price-history__modal-toggler",attrs:{theme:"link"},on:{click:o.onOpenHistoryModal}},[e._v("\n      "+e._s(e.$t("offers.show_more_price_history"))+"\n    ")])],1),e._v(" "),t("BaseModal",{attrs:{"modal-id":o.modalPriceHistoryId,scrollable:"","content-style":"max-width: min(calc(100vw - 3.2rem), 37.4rem); margin: 0 max(1.6rem, calc(50% - 18.7rem));"}},[t("div",{staticClass:"modal-body price-history-modal"},[t("div",{staticClass:"price-history-modal__header"},[t("span",{staticClass:"price-history-modal__header__icon"}),e._v("\n        "+e._s(e.$t("offers.price_history"))+"\n        "),t("div",{staticClass:"icon-times-light price-history-modal__close z-index__2",attrs:{tabindex:"0"},on:{click:o.onHideHistoryModal}})]),e._v(" "),t("div",{staticClass:"price-history-modal__title"},[e._v("\n        "+e._s(o.props.product.name)+"\n      ")]),e._v(" "),t("div",{staticClass:"price-history-modal__list"},e._l(o.historyToShow,(function(r,n){return t("div",{key:r.created_at,staticClass:"price-history-modal__list__item"},[t("div",{staticClass:"price-history-modal__list__item__block",class:{"price-history-modal__list__item__block__actual":n===o.historyToShow.length-1},style:{height:o.getBlockHeight(r.price)+"%"}},[t("span",{staticClass:"price-history-modal__list__item__change"},[e._v("\n              "+e._s(r.price_change)+"\n            ")]),e._v(" "),t("span",{staticClass:"price-history-modal__list__item__price"},[e._v("\n              "+e._s(r.price)+" "),t("span",{staticClass:"icon-hryvnia"})])]),e._v(" "),t("div",{staticClass:"price-history-modal__list__item__time"},[e._v("\n            "+e._s(r.formatedTime)+"\n          ")])])})),0),e._v(" "),t("div",{staticClass:"price-history-modal__total-change"},[t("span",{staticClass:"icon-info-circle price-history-modal__total-change__icon"}),e._v(" "),o.totalDays?[e._v("\n          "+e._s(e.$tc("offers.total_price_change_range_pluralized",o.totalDays,{count:o.totalDays}))+"\n        ")]:[e._v("\n          "+e._s(e.$t("offers.total_price_change_today"))+"\n        ")],e._v(" "),t("span",{staticClass:"price-history-modal__total-change__percent"},[e._v("\n          "+e._s(o.totalChange)+"\n        ")])],2),e._v(" "),t("div",{staticClass:"price-history-modal__actions"},[t(o.BaseButton,{attrs:{theme:"accent",fullWidth:"",loading:o.isAddingCart,outline:o.isOfferInCart,disabled:o.disableBuyButton},on:{click:o.handleAddToCart}},[t("span",{style:{color:o.isOfferInCart?"#00c84a":"inherit"}},[o.isAddingCart?e._e():t("span",{class:[o.isOfferInCart?"icon-cart-full":"icon-cart"],staticStyle:{"margin-right":"0.5rem"}}),e._v("\n            "+e._s(o.isOfferInCart?e.$t("product.in_cart"):e.$t("product.buy"))+"\n          ")])]),e._v(" "),t(o.BaseButton,{attrs:{theme:"accent",outline:"",fullWidth:"",loading:o.isFetching,styl:""},on:{click:function(e){return o.toggleWishlist()}}},[e._v("\n          "+e._s(o.inWishlist?e.$t("offers.unsubscribe_price_changes"):e.$t("offers.subscribe_price_changes"))+"\n        ")])],1)])])],1)}),[],!1,null,"5f9960ba",null);t.default=component.exports}}]);